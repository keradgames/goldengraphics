var PIXI=PIXI||{};PIXI.EventTarget=function(){var a={};this.addEventListener=this.on=function(b,c){void 0===a[b]&&(a[b]=[]),-1===a[b].indexOf(c)&&a[b].push(c)},this.dispatchEvent=this.emit=function(b){for(var c in a[b.type])a[b.type].hasOwnProperty(c)&&a[b.type][c](b)},this.removeEventListener=this.off=function(b,c){var d=a[b].indexOf(c);-1!==d&&a[b].splice(d,1)}},function(a){var b={};b.filters={},function(){var a=!1,b=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(c){function d(){!a&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;a=!0;var f=new this;a=!1;for(var g in c)f[g]="function"==typeof c[g]&&"function"==typeof e[g]&&b.test(c[g])?function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);return this._super=c,d}}(g,c[g]):c[g];return d.prototype=f,d.prototype.constructor=d,d.extend=arguments.callee,d}}(),b.Base=Class.extend({init:function(){}}),b.Color=b.Base.extend({init:function(a,b,c,d){this._super(),this.r=a||0,this.g=b||0,this.b=c||0,this.a=void 0!=d?d:1},multiply:function(a){return a}}),b.Color.fromHex=function(a){var c=null,d=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(d,function(a,b,c,d){return b+b+c+c+d+d});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return e&&(c=new b.Color(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16))),c},b.Point2D=b.Base.extend({init:function(a,b){this._super(),this.x=a||0,this.y=b||0}}),b.ImageLoader=b.Base.extend({init:function(a){PIXI.EventTarget.call(this),this.url=a},load:function(){var a=this;b.BaseTexture.cache[this.url]?(this.img=b.BaseTexture.cache[this.url],this.onLoaded()):(this.img=new Image,this.img.addEventListener("load",function(){b.BaseTexture.cache[a.url]=a.img,a.onLoaded()}),this.img.addEventListener("error",function(){a.onError()}),this.img.src=this.url)},onLoaded:function(){this.dispatchEvent({type:"loaded",content:this})},onError:function(){this.dispatchEvent({type:"error",content:this})}}),b.AssetLoader=b.Base.extend({init:function(a,c){PIXI.EventTarget.call(this),this.assetURLs=a,this.crossorigin=c,this.loadersByType={jpg:b.ImageLoader,jpeg:b.ImageLoader,png:b.ImageLoader,gif:b.ImageLoader}},load:function(){var a=this;this.loadCount=this.assetURLs.length;for(var b=0;b<this.assetURLs.length;b++){var c=this.assetURLs[b],d=c.split(".").pop().toLowerCase(),e=this.loadersByType[d];if(!e)throw new Error(d+" is an unsupported file type");var f=new e(c,this.crossorigin);f.addEventListener("loaded",function(){a.onAssetLoaded()}),f.addEventListener("error",function(){a.onError()}),f.load()}},onAssetLoaded:function(){this.loadCount--,this.dispatchEvent({type:"onProgress",content:this}),this.onProgress&&this.onProgress(),0==this.loadCount&&(this.dispatchEvent({type:"onComplete",content:this}),this.onComplete&&this.onComplete())},onError:function(){this.dispatchEvent({type:"onError",content:this})}}),b.CanvasRenderer=b.Base.extend({init:function(){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.context.globalCompositeOperation="destination-over",this.imageData=this.context.createImageData(this.canvas.width,this.canvas.height)},render:function(a){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);var b=(new Date).getTime();a?this._updateImageData(a):console.log("Stage is not defined");var c=(new Date).getTime();console.log("render",c-b)},resize:function(a,b){this.canvas.width=a,this.canvas.height=b},_updateImageData:function(a){var b=null,c=0,d=0;if(a&&a.stage){a._render=a._render||{},a._render._canvas?a._render._context.clearRect(0,0,a._render._canvas.width,a._render._canvas.height):this._createTextureCanvas(a),a._render._imageToRender=new Image,!a._render._imageToRender,a.texture&&a._render._context.drawImage(a.texture,0,0,a.texture.width,a.texture.height);for(var e in a.children)if(a.children.hasOwnProperty(e)&&(b=a.children[e],c=Math.round(b.position.x),d=Math.round(b.position.y),b.opacity>0&&(this._updateImageData(b),b._render._imageToRender))){for(var f=(new Date).getTime(),g=(new Date).getTime(),h=500;!b._render._imageToRender.complete&&h>g-f;)g=(new Date).getTime();b._render._imageToRender.complete?a._render._context.drawImage(b._render._imageToRender,c,d,b._render._imageToRender.naturalWidth,b._render._imageToRender.naturalHeight):(console.log(b._render._imageToRender.complete,b._render._imageToRender.naturalWidth,b._render._imageToRender.naturalHeight),b._render._imageToRender.onload=function(){})}a.filters&&a.filters.length>0?(this._applyFilters(a),a._render._imageToRender.src=a._render._canvas.toDataURL()):a.children.length>0?a._render._imageToRender.src=a._render._canvas.toDataURL():a._render._imageToRender=a.texture}},_cacheImageData:function(a){a.texture&&(a.cachedImageData=this.getImageData(a.texture),a.imageData=this.cloneImageData(a.cachedImageData))},_createTextureCanvas:function(a){a._render=a._render||{},a.stage==a?(a._render._canvas=this.canvas,a._render._context=this.context):(a._render._canvas=document.createElement("canvas"),a._render._context=a._render._canvas.getContext("2d"),document.body.appendChild(a._render._canvas),a.texture?(a._render._canvas.width=a.texture.width,a._render._canvas.height=a.texture.height):(a._render._canvas.width=this.canvas.width,a._render._canvas.height=this.canvas.height))},_applyFilters:function(a){for(var b in a.filters)if(a.filters.hasOwnProperty(b)){var c=a._render._context.getImageData(0,0,a._render._canvas.width,a._render._canvas.height),d=a._render._context.createImageData(c);a.filters[b].apply(c,d),a._render._context.putImageData(d,0,0)}},getImageData:function(a){var b=null,c=Math.min(a.width,this.canvas.width),d=Math.min(a.height,this.canvas.height);return this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.drawImage(a,0,0),b=this.context.getImageData(0,0,c,d),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),b},cloneImageData:function(a){for(var b=this.context.createImageData(a),c=b.data.length,d=0;c>d;d++)b.data[d]=a.data[d];return b}}),b.BaseTexture=b.Base.extend({init:function(){}}),b.BaseTexture.cache={},b.DisplayObjectContainer=b.Base.extend({init:function(){this.children=[],this.filters=[],this.imageData=null,this.position=new b.Point2D,this.opacity=1,this.parent=null},addChild:function(a){this.addChildAt(a,this.children.length)},addChildAt:function(a,b){b>this.children.length&&(b=this.children.length),this.children.indexOf(a)<0&&(this.children.splice(b,0,a),a.parent=this,this._addChildToStage(a))},removeChild:function(a){this.children.indexOf(a)>-1&&(this.children.splice(this.children.indexOf(a),1),this._removeChildFromStage(a),a.parent=null)},contains:function(a){return this.children.indexOf(a)>-1},_addChildToStage:function(a){if(a.stage!=this.stage){a.stage=this.stage;for(var b in a.children)a.children.hasOwnProperty(b)&&this._addChildToStage(a.children[b])}},_removeChildFromStage:function(a){a.stage=null;for(var b in a.children)a.children.hasOwnProperty(b)&&this._removeChildFromstage(a.children[b])},_updateImageData:function(){var a=0,b=null,c=null,d=null,b=null,e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p="";if(this.stage){for(var q in this.children)if(this.children.hasOwnProperty(q)&&(b=b||this.cachedImageData?this.cachedImageData:this.stage.renderer.context.createImageData(this.stage.renderer.canvas.width,this.stage.renderer.canvas.height),d=this.children[q],c=d.imageData,l=Math.round(d.position.x),m=Math.round(d.position.y),d.opacity>0&&c)){e=b.data.length-1,d._updateImageData();for(var r=0;r<c.width;r++)for(var s=0;s<c.height;s++)a=4*(r*c.width+s),n=s+l,o=r+m,n>=0&&o>=0&&n<b.width&&o<b.height&&(renderPos=4*(o*b.width+n),f=c.data[a+0],g=c.data[a+1],h=c.data[a+2],j=c.data[a+3],i=j/255*d.opacity,i>0&&e>renderPos&&(k=b.data[renderPos+3]/255||1,b.data[renderPos+0]=f*i+(1-i)*b.data[renderPos+0]*k,b.data[renderPos+1]=g*i+(1-i)*b.data[renderPos+1]*k,b.data[renderPos+2]=h*i+(1-i)*b.data[renderPos+2]*k,b.data[renderPos+3]=Math.max(j*i,b.data[renderPos+3])))}this.applyFilters(),p&&p.length>0&&console.log(p),this.imageData=b||this.imageData}}}),b.Stage=b.DisplayObjectContainer.extend({init:function(){this._super(),this.stage=this}}),b.Sprite=b.DisplayObjectContainer.extend({init:function(a){function b(){c.texture=a}this._super();var c=this;this.cachedImageData=null,a.complete?b():a.addEventListener("load",b)}}),b.Sprite.fromImageUrl=function(a){var c=b.BaseTexture.cache[a]||new Image,d=null;return c.src||(c.src=a),d=new b.Sprite(c)},b.filters.TintFilter=b.Base.extend({init:function(){this._super();var a=null;a=1==arguments.length?arguments[0]:new b.Color(arguments[0],arguments[1],arguments[2],arguments[3]),this.color=a,this._prevColor=null},apply:function(a,b){for(var c=0,d=0,e=parseInt(this.color.r),f=parseInt(this.color.g),g=parseInt(this.color.b),h=0;h<a.width;h++)for(var i=0;i<a.height;i++){var j=(a.data[d++],a.data[d++],a.data[d++],a.data[d++]);j>0?(b.data[c]=e*a.data[c]/255,c++,b.data[c]=f*a.data[c]/255,c++,b.data[c]=g*a.data[c]/255,c++,b.data[c]=a.data[c],c++):c+=4}}}),a.GoldenGraphics=b}(window);
!function(a){var b={};b.filters={},function(){var a=!1,b=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(c){function d(){!a&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;a=!0;var f=new this;a=!1;for(var g in c)f[g]="function"==typeof c[g]&&"function"==typeof e[g]&&b.test(c[g])?function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);return this._super=c,d}}(g,c[g]):c[g];return d.prototype=f,d.prototype.constructor=d,d.extend=arguments.callee,d}}(),b.Base=Class.extend({init:function(){}}),b.Color=b.Base.extend({init:function(a,b,c,d){this._super(),this.r=a||0,this.g=b||0,this.b=c||0,this.a=void 0!=d?d:1},multiply:function(a){return a}}),b.Point2D=b.Base.extend({init:function(a,b){this._super(),this.x=a||0,this.y=b||0}}),b.CanvasRenderer=b.Base.extend({init:function(a){this.canvas=a,this.context=this.canvas.getContext("2d"),this.stage=new b.Stage(this),this.imageData=this.context.createImageData(this.canvas.width,this.canvas.height),b.CanvasRenderer.instance=this},render:function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.stage._updateImageData(),this.stage.imageData&&this.context.putImageData(this.stage.imageData,0,0)}}),b.CanvasRenderer.instance=null,b.CanvasRenderer.getImageData=function(a){var c=b.CanvasRenderer.instance,d=null,e=a.width,f=a.height;return c.context.clearRect(0,0,c.canvas.width,c.canvas.height),c.context.drawImage(a,0,0),d=c.context.getImageData(0,0,e,f),c.render(),d},b.CanvasRenderer.cloneImageData=function(a){for(var c=b.CanvasRenderer.instance,d=c.context.createImageData(a),e=d.data.length,f=0;e>f;f++)d.data[f]=a.data[f];return d},b.DisplayObjectContainer=b.Base.extend({init:function(){this.children=[],this.filters=[],this.imageData=null,this.parent=null},addChild:function(a){this.children.indexOf(a)<0&&this.children.push(a),a.parent=this,this._addChildToStage(a)},removeChild:function(){},applyFilters:function(){for(var a in this.filters)this.filters[a].apply(this.cachedImageData,this.imageData)},_addChildToStage:function(a){if(a.stage!=this.stage){a.stage=this.stage;for(var b in a.children)this._addChildToStage(a.children[b])}},_updateImageData:function(){var a=0,b=null,c=null,d=null,b=null,e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p="";if(this.stage){for(var q in this.children)if(b=b||this.cachedImageData?this.cachedImageData:this.stage.renderer.context.createImageData(this.stage.renderer.canvas.width,this.stage.renderer.canvas.height),d=this.children[q],c=d.imageData,l=Math.round(d.position.x),m=Math.round(d.position.y),d.opacity>0&&c){e=b.data.length-1,d._updateImageData();for(var r=0;r<c.width;r++)for(var s=0;s<c.height;s++)a=4*(r*c.width+s),n=s+l,o=r+m,n>=0&&o>=0&&n<b.width&&o<b.height&&(renderPos=4*(o*b.width+n),f=c.data[a+0],g=c.data[a+1],h=c.data[a+2],j=c.data[a+3],i=j/255*d.opacity,i>0&&e>renderPos&&(k=b.data[renderPos+3]/255||1,b.data[renderPos+0]=f*i+(1-i)*b.data[renderPos+0]*k,b.data[renderPos+1]=g*i+(1-i)*b.data[renderPos+1]*k,b.data[renderPos+2]=h*i+(1-i)*b.data[renderPos+2]*k,b.data[renderPos+3]=Math.max(j*i,b.data[renderPos+3])))}this.applyFilters(),p&&p.length>0&&console.log(p),this.imageData=b||this.imageData}}}),b.Stage=b.DisplayObjectContainer.extend({init:function(a){this._super(),this.renderer=a,this.stage=this}}),b.Sprite=b.DisplayObjectContainer.extend({init:function(a){function c(){d.cachedImageData=b.CanvasRenderer.getImageData(this),d.imageData=b.CanvasRenderer.cloneImageData(d.cachedImageData)}this._super();var d=this;this.cachedImageData=null,this.position=new b.Point2D,this.filters=[],this.opacity=1,a.addEventListener("load",c)}}),b.Sprite.fromImageUrl=function(a){var c=new Image,d=null;return c.src=a,d=new b.Sprite(c)},b.filters.TintFilter=b.Base.extend({init:function(){this._super();var a=null;a=1==arguments.length?arguments[0]:new b.Color(arguments[0],arguments[1],arguments[2],arguments[3]),this.color=a},apply:function(a,b){for(var c=0,d=0,e=this.color.r,f=this.color.g,g=this.color.b,h=0;h<a.width;h++)for(var i=0;i<a.height;i++){var j=(a.data[d++],a.data[d++],a.data[d++],a.data[d++]);j>0?(b.data[c]=e*a.data[c]/255,c++,b.data[c]=f*a.data[c]/255,c++,b.data[c]=g*a.data[c]/255,c++,b.data[c]=a.data[c],c++):c+=4}}}),a.GoldenGraphics=b}(window);
!function(a){var b={};b.filters={},function(){var a=!1,b=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(c){function d(){!a&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;a=!0;var f=new this;a=!1;for(var g in c)f[g]="function"==typeof c[g]&&"function"==typeof e[g]&&b.test(c[g])?function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);return this._super=c,d}}(g,c[g]):c[g];return d.prototype=f,d.prototype.constructor=d,d.extend=arguments.callee,d}}(),b.Base=Class.extend({init:function(){}}),b.Color=b.Base.extend({init:function(a,b,c,d){this._super(),this.r=a||0,this.g=b||0,this.b=c||0,this.a=void 0!=d?d:1},multiply:function(a){return a}}),b.Color.fromHex=function(a){var c=null,d=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(d,function(a,b,c,d){return b+b+c+c+d+d});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return e&&(c=new b.Color(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16))),c},b.Point2D=b.Base.extend({init:function(a,b){this._super(),this.x=a||0,this.y=b||0}}),b.CanvasRenderer=b.Base.extend({init:function(){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.imageData=this.context.createImageData(this.canvas.width,this.canvas.height)},render:function(a){this.context.clearRect(0,0,this.canvas.width,this.canvas.height),a?(this._updateImageData(a),a.imageData&&this.context.putImageData(a.imageData,0,0)):console.log("Stage is not defined")},resize:function(a,b){this.canvas.width=a,this.canvas.height=b},_updateImageData:function(a){var b=0,c=null,d=null,e=null,c=null,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q="";if(a&&a.stage){a.cachedImageData||this._cacheImageData(a);for(var r in a.children)if(a.children.hasOwnProperty(r)&&(c||(c=a.cachedImageData?a.cachedImageData:this.context.createImageData(this.canvas.width,this.canvas.height)),e=a.children[r],e.texture&&!e.cachedImageData&&this._cacheImageData(e),m=Math.round(e.position.x),n=Math.round(e.position.y),e.opacity>0&&(e.children.length>0||c&&e.imageData))){f=c.data.length-1,this._updateImageData(e),d=e.imageData;for(var s=0;s<d.width;s++)for(var t=0;t<d.height;t++)b=4*(s*d.width+t),o=t+m,p=s+n,o>=0&&p>=0&&o<c.width&&p<c.height&&(renderPos=4*(p*c.width+o),g=d.data[b+0],h=d.data[b+1],i=d.data[b+2],k=d.data[b+3],j=k/255*e.opacity,j>0&&f>renderPos&&(l=c.data[renderPos+3]/255||1,c.data[renderPos+0]=g*j+(1-j)*c.data[renderPos+0]*l,c.data[renderPos+1]=h*j+(1-j)*c.data[renderPos+1]*l,c.data[renderPos+2]=i*j+(1-j)*c.data[renderPos+2]*l,c.data[renderPos+3]=Math.max(k*j,c.data[renderPos+3])))}this._applyFilters(a),q&&q.length>0&&console.log(q),a.imageData=c||a.imageData}},_cacheImageData:function(a){a.texture&&(a.cachedImageData=this.getImageData(a.texture),a.imageData=this.cloneImageData(a.cachedImageData))},_applyFilters:function(a){if(a.cachedImageData&&a.imageData)for(var b in a.filters)a.filters.hasOwnProperty(b)&&a.filters[b].apply(a.cachedImageData,a.imageData)},getImageData:function(a){var b=null,c=Math.min(a.width,this.canvas.width),d=Math.min(a.height,this.canvas.height);return this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.drawImage(a,0,0),b=this.context.getImageData(0,0,c,d),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),b},cloneImageData:function(a){for(var b=this.context.createImageData(a),c=b.data.length,d=0;c>d;d++)b.data[d]=a.data[d];return b}}),b.DisplayObjectContainer=b.Base.extend({init:function(){this.children=[],this.filters=[],this.imageData=null,this.position=new b.Point2D,this.opacity=1,this.parent=null},addChild:function(a){this.addChildAt(a,this.children.length)},addChildAt:function(a,b){b>this.children.length&&(b=this.children.length),this.children.indexOf(a)<0&&(this.children.splice(b,0,a),a.parent=this,this._addChildToStage(a))},removeChild:function(a){this.children.indexOf(a)>-1&&(this.children.splice(this.children.indexOf(a),1),this._removeChildFromStage(a),a.parent=null)},contains:function(a){return this.children.indexOf(a)>-1},_addChildToStage:function(a){if(a.stage!=this.stage){a.stage=this.stage;for(var b in a.children)a.children.hasOwnProperty(b)&&this._addChildToStage(a.children[b])}},_removeChildFromStage:function(a){a.stage=null;for(var b in a.children)a.children.hasOwnProperty(b)&&this._removeChildFromstage(a.children[b])},_updateImageData:function(){var a=0,b=null,c=null,d=null,b=null,e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p="";if(this.stage){for(var q in this.children)if(this.children.hasOwnProperty(q)&&(b=b||this.cachedImageData?this.cachedImageData:this.stage.renderer.context.createImageData(this.stage.renderer.canvas.width,this.stage.renderer.canvas.height),d=this.children[q],c=d.imageData,l=Math.round(d.position.x),m=Math.round(d.position.y),d.opacity>0&&c)){e=b.data.length-1,d._updateImageData();for(var r=0;r<c.width;r++)for(var s=0;s<c.height;s++)a=4*(r*c.width+s),n=s+l,o=r+m,n>=0&&o>=0&&n<b.width&&o<b.height&&(renderPos=4*(o*b.width+n),f=c.data[a+0],g=c.data[a+1],h=c.data[a+2],j=c.data[a+3],i=j/255*d.opacity,i>0&&e>renderPos&&(k=b.data[renderPos+3]/255||1,b.data[renderPos+0]=f*i+(1-i)*b.data[renderPos+0]*k,b.data[renderPos+1]=g*i+(1-i)*b.data[renderPos+1]*k,b.data[renderPos+2]=h*i+(1-i)*b.data[renderPos+2]*k,b.data[renderPos+3]=Math.max(j*i,b.data[renderPos+3])))}this.applyFilters(),p&&p.length>0&&console.log(p),this.imageData=b||this.imageData}}}),b.Stage=b.DisplayObjectContainer.extend({init:function(){this._super(),this.stage=this}}),b.Sprite=b.DisplayObjectContainer.extend({init:function(a){function b(){c.texture=this}this._super();var c=this;this.cachedImageData=null,this.texture=null,a.addEventListener("load",b)}}),b.Sprite.fromImageUrl=function(a){var c=new Image,d=null;return c.src=a,d=new b.Sprite(c)},b.filters.TintFilter=b.Base.extend({init:function(){this._super();var a=null;a=1==arguments.length?arguments[0]:new b.Color(arguments[0],arguments[1],arguments[2],arguments[3]),this.color=a,this._prevColor=null},apply:function(a,c){var d=0,e=0,f=this.color.r,g=this.color.g,h=this.color.b;if(!this._prevColor||this._prevColor.r!=this.color.r||this._prevColor.g!=this.color.g||this._prevColor.b!=this.color.b){for(var i=0;i<a.width;i++)for(var j=0;j<a.height;j++){var k=(a.data[e++],a.data[e++],a.data[e++],a.data[e++]);k>0?(c.data[d]=f*a.data[d]/255,d++,c.data[d]=g*a.data[d]/255,d++,c.data[d]=h*a.data[d]/255,d++,c.data[d]=a.data[d],d++):d+=4}this._prevColor?(this._prevColor.r=this.color.r,this._prevColor.g=this.color.g,this._prevColor.b=this.color.b,this._prevColor.a=this.color.a):this._prevColor=new b.Color(this.color.r,this.color.g,this.color.b,this.color.a)}}}),a.GoldenGraphics=b}(window);